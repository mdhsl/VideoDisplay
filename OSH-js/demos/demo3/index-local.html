<!DOCTYPE HTML>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <title>OSH Leaflet viewer</title>
    
    <script type="text/javascript" src= "../../vendor/broadway/Decoder.js"></script>
    <script type="text/javascript" src= "../../vendor/broadway/YUVCanvas.js"></script>
    <script type="text/javascript" src= "../../vendor/broadway/Player.js"></script>
    
    <script type="text/javascript" src= "../../src/common/prototype.min.js"></script>
    
    <!-- OSH Core -->
    <script type="text/javascript" src="../../src/osh/osh-template.js"></script>
    <!-- OSH buffer sync lib -->
    <script type="text/javascript" src="../../src/osh/osh-Utils.js"></script>
    
    <script type="text/javascript" src="../../src/osh/osh-Buffer.js"></script>
    <!-- OSH controller lib -->
    <script type="text/javascript" src="../../src/osh/osh-Controller.js"></script>
    <!-- OSH Video component parser -->
    <script type="text/javascript" src="../../src/osh/dataconnector/osh-DataConnector.js"></script>
    <script type="text/javascript" src="../../src/osh/dataconnector/osh-DataConnector-Websocket.js"></script>
    <script type="text/javascript" src="../../src/osh/dataprovider/osh-DataProvider.js"></script>
    <script type="text/javascript" src="../../src/osh/dataprovider/osh-DataProviderController.js"></script>
    <script type="text/javascript" src="../../src/osh/dataprovider/osh-DataProvider-VideoH264.js"></script>
    <script type="text/javascript" src="../../src/osh/dataprovider/osh-DataProvider-VideoMjpeg.js"></script>
    <script type="text/javascript" src="../../src/osh/dataprovider/osh-DataProvider-VideoMp4.js"></script>
    <script type="text/javascript" src="../../src/osh/dataprovider/osh-DataProvider-Video.js"></script>
    
    <script type="text/javascript" src="../../src/osh/ui/view/osh-UI-View.js"></script>
    <script type="text/javascript" src="../../src/osh/ui/view/osh-UI-MjpegView.js"></script>
    <script type="text/javascript" src="../../src/osh/ui/view/osh-UI-Mp4View.js"></script>
    <script type="text/javascript" src="../../src/osh/ui/view/osh-UI-H264View.js"></script>
    <script type="text/javascript" src="../../src/osh/ui/view/osh-UI-VideoView.js"></script>
	<style media="screen" type="text/css">
	html, body {
		height: 100%;
		margin: 0;
	}
	
	.video {
		width: 400px;
		height: 400px;
	}
	
	</style>
</head>
    <body>
     <h2>This is an example of MP4 RealTime data use</h2>
	 <div id="madison-virb1-video-mp4"></div>
	<script type="text/javascript">
		var dataProviderController = new OSH.DataProvider.DataProviderController(
				{
					bufferingTime : 0 * 1000, // 2 seconds
					synchronizedTime : false // does not sync the data
				});

		// creates datasource
		/*var madisonAndroidVideoMjpeg = new OSH.DataProvider.Video(
				"madisonAndroidVideoMjpeg",
				"ws://bottsgeo.com:8080/sensorhub/sos?service=SOS&version=2.0&request=GetResult&offering=urn:android:device:89845ed469b7edc7-http://www.bottsgeo.com:8080/sensorhub/sos?service=SOS&version=2.0&request=GetResult&offering=urn:android:device:89845ed469b7edc7-sos&observedProperty=http://sensorml.com/ont/swe/property/VideoFrame&temporalFilter=time,2016-06-08T19:46:24.732Z/2016-06-08T20:35:06.983Z&replaySpeed=1",
				{
					format: "mjpeg"					
				});
		
		var madisonVirb1Video = new OSH.DataProvider.Video(
				"madisonVirb1Video",
				"ws://www.bottsgeo.com:8080/sensorhub/sos?service=SOS&version=2.0&request=GetResult&offering=urn:osh:virb1&observedProperty=http://sensorml.com/ont/swe/property/VideoFrame&temporalFilter=time,2016-06-08T19:35:27.413Z/2016-06-08T20:35:06.983Z&replaySpeed=1&responseFormat=video/mp4",
				{
					format: "mp4"					
				});*/
		
		var madisonVirb1Video = new OSH.DataProvider.Video(
				"madisonVirb1Video",
				"ws://www.bottsgeo.com:8080/sensorhub/sos?service=SOS&version=2.0&request=GetResult&offering=urn:osh:virb1&observedProperty=http://sensorml.com/ont/swe/property/VideoFrame&temporalFilter=time,2016-06-08T19:35:27.413Z/2016-06-08T20:35:06.983Z&replaySpeed=1&responseFormat=video/mp4",
				{
					format: "mp4"					
				});
		
		/*var madisonFlirMjpeg = new OSH.DataProvider.Video(
				"madisonFlirMjpeg",
				"ws://www.bottsgeo.com:8080/sensorhub/sos?service=SOS&version=2.0&request=GetResult&offering=urn:android:device:89845ed469b7edc7:flirone-sos&observedProperty=http://sensorml.com/ont/swe/property/VideoFrame&temporalFilter=time,2016-06-08T19:59:31.535Z/2016-06-08T20:35:06.983Z&replaySpeed=1",
				{
					format: "mjpeg"					
				});*/
		
		// creates view
		/*var view1 = new OSH.UI.VideoView("madison-android-video-mjpeg",{
			dataSourceId:madisonAndroidVideoMjpeg.getId(),
			format: "mjpeg",
			css:"video"
		});*/

		var view2 = new OSH.UI.VideoView("madison-virb1-video-mp4",{
			dataSourceId:madisonVirb1Video.getId(),
			format: "mp4",
			css:"video"
		});
		
		/*var view3 = new OSH.UI.VideoView("madison-virb2-video-h264",{
			dataSourceId:madisonVirb2VideoH264.getId(),
			format: "mp4",
			css:"video"
		});
		
		var view4 = new OSH.UI.VideoView("madison-flir-mjpeg",{
			dataSourceId:madisonFlirMjpeg.getId(),
			format: "mjpeg",
			css:"video"
		});*/
		
		// adds datasources to dataProviderController
		//dataProviderController.addDataSource(madisonAndroidVideoMjpeg);
		//dataProviderController.addDataSource(madisonVirb1Video);
		dataProviderController.addDataSource(madisonVirb1Video);
		//dataProviderController.addDataSource(madisonFlirMjpeg);
		
		// registers the view into the data provider
		//dataProviderController.registerObserver(view1);
		dataProviderController.registerObserver(view2);
		//dataProviderController.registerObserver(view3);
		//dataProviderController.registerObserver(view4);
		
		dataProviderController.connectAll();
	</script>

</body>
</html>
