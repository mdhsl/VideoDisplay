<div id="videoViewerId">
 <img id="video" width="100%" height="100%"></img>
<script>
var lastTime = 0;
var url = "ws://sensiasoft.net:8181/sensorhub/sos?service=SOS&version=2.0&request=GetResult&offering=urn:android:device:060693280a28e015-sos&observedProperty=http://sensorml.com/ont/swe/property/VideoFrame&temporalFilter=phenomenonTime,2015-02-16T07:58:00Z/2015-02-16T08:09:00Z&replaySpeed=2";
var imgTag = document.getElementById("video");

function onCallback(data) {
    var imgBlob = new Blob([data]);
    var blobURL = window.URL.createObjectURL(imgBlob.slice(12));
    var oldBlobURL = imgTag.src;
    imgTag.src = blobURL;
    window.URL.revokeObjectURL(oldBlobURL);
}

function initStream() {

    var timeStampParser = function(data) {
        return new DataView(data).getFloat64(0, false) * 1000; // read double time stamp as big endian
    };
    
    var controller = OSH.Controller.getSingleton();
    controller.addDataSource(this,url,"video",timeStampParser,onCallback);
}

window.setTimeout(function() {
  initStream();
}, 4000);
</script>
</div>

